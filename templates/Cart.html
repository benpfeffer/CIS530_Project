<!DOCTYPE html>
<html style="font-size: 16px;" lang="en">
  <link rel="stylesheet" href="{{cart_css}}" media="screen">
  <link rel="stylesheet" href="{{style}}" media="screen">
  <script
  src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<head>
    <!-- Head content -->
</head>
<body class="u-body u-xl-mode" data-lang="en">
<header class="u-clearfix u-header u-header" id="sec-c173">
    <div class="u-clearfix u-sheet u-sheet-1">
        <a href="/" class="u-btn u-btn-round u-button-style u-hover-palette-1-light-1 u-palette-1-base u-radius-50 u-btn-1">HOME
        </a>
    </div>
</header>
<section class="u-clearfix u-section-1" id="sec-f8b5">
    <div class="u-clearfix u-sheet u-sheet-1">
        <div class="row">
            <div class="column">
                <h2 class="u-custom-font u-font-oswald u-text u-text-default u-text-palette-2-base u-text-21 font-oswald">Cart Items</h2>
                <div id="cart-container"></div>
            </div>

            <!-- Recommended Items Section -->
            <div class="column">
                <h2 class="u-custom-font u-font-oswald u-text u-text-default u-text-palette-2-base u-text-21 font-oswald">Recommended Items</h2>
                <div class="u-expanded-width u-list u-list-2">
                    <div class="u-repeater u-repeater-2">
                        <!-- Recommended items will be added here -->
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
</body>
<script>
    // Script content

    const cart = JSON.parse(localStorage.cart) || [];

    function gen_remove(index) {
        return (event) => {
            cart.splice(index, 1);
            localStorage.setItem('cart', JSON.stringify(cart));
            location.reload();
        }
    }

    function populateCart() {
        const cartContainer = document.createElement('table');

        cart.forEach((item, index) => {
            const itemRow = document.createElement('tr');

            const itemTag = document.createElement('p');
            itemTag.textContent = `${item.name} - $${item.price}`;
            
            const removeButton = document.createElement('button');
            removeButton.textContent =  `remove`;
            removeButton.onclick = gen_remove(index);

            tagCell = document.createElement('th');
            tagCell.appendChild(itemTag);
            removeCell = document.createElement('th');
            removeCell.appendChild(removeButton);

            itemRow.appendChild(tagCell);
            itemRow.appendChild(removeCell);

            cartContainer.appendChild(itemRow);
        });

        document.querySelector('#cart-container').appendChild(cartContainer);
    }

    function populateCharts() {
        console.log(cart);
        $.ajax({
            url: `${location.origin}/plot`,
            method: 'POST',
            contentType: 'application/json',
            success: (response) => {
                console.log(response)
            }
        })
    }

    document.addEventListener('DOMContentLoaded', function () {
        populateCart();
        populateCharts();



    });
</script>
</html>
